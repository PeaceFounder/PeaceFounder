<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>PeaceFounder.AuditTools · PeaceFounder.jl</title><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img src="../assets/logo.svg" alt="PeaceFounder.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../">PeaceFounder.jl</a></span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">PeaceFounder.jl</a></li><li><a class="tocitem" href="../overview/">Overview</a></li><li><a class="tocitem" href="../setup/">Setup</a></li><li><a class="tocitem" href="../client/">Client</a></li><li><a class="tocitem" href="../audit/">Audit</a></li><li><span class="tocitem">API</span><ul><li><a class="tocitem" href="../schema/">REST</a></li><li><a class="tocitem" href="../model_api/">PeaceFounder.Model</a></li><li class="is-active"><a class="tocitem" href>PeaceFounder.AuditTools</a></li><li><a class="tocitem" href="../schedulers/">PeaceFounder.Schedulers</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">API</a></li><li class="is-active"><a href>PeaceFounder.AuditTools</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>PeaceFounder.AuditTools</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/PeaceFounder/PeaceFounder.jl/blob/master/docs/src/audittools.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="PeaceFounder.AuditTools"><a class="docs-heading-anchor" href="#PeaceFounder.AuditTools">PeaceFounder.AuditTools</a><a id="PeaceFounder.AuditTools-1"></a><a class="docs-heading-anchor-permalink" href="#PeaceFounder.AuditTools" title="Permalink"></a></h1><p><strong>Note: follow the feature proposal <a href="https://github.com/PeaceFounder/PeaceFounder.jl/issues/19">https://github.com/PeaceFounder/PeaceFounder.jl/issues/19</a></strong></p><pre><code class="language-docs hljs">PeaceFounder.AuditTools</code></pre><article class="docstring"><header><a class="docstring-binding" id="PeaceFounder.AuditTools" href="#PeaceFounder.AuditTools"><code>PeaceFounder.AuditTools</code></a> — <span class="docstring-category">Module</span></header><section><div><p>After ellections have ended the collector publishes a tally. To assert that votes have been  accuratelly counted and that only legitimate voters have participated an audit takes place.</p><p>Every voter after ellections receives a final tally together with a consistency proof  which proves that their vote is included in the ledger which have produced the tally.  From the voter client voter reads four important parameters for the ballotbox:</p><ul><li><code>deme_uuid</code>: an UUID of the deme where the proposal is registered;</li><li><code>proposal_index</code>: a index at which the proposal is recorded in the braidchain ledger;</li><li><code>ledger_length</code>: a number of collected votes in the ledger;</li><li><code>ledger_root</code>: a ballotbox ledger root checksum.</li></ul><p>The auditor also knows a <code>hasher</code> deme uses to make checksums which is immutable at the moment deme is created.</p><p>Let&#39;s consider abstract functions to retrieve ballotbox and braidchain ledger archives from the internet with <code>get_ballotbox_archive</code> and <code>get_braidchain_archive</code> then the auditing can be done with a following script:</p><pre><code class="nohighlight hljs">braidchain_archive = get_ballotbox_archive(uuid)
ballotbox_archive = get_ballotbox_archive(uuid, proposal_index)[1:ledger_length]

@test checksum(ballotbox_archive, hasher) == ledger_root
@test isbinding(braidchain_archive, ballotbox_archive, hasher)

spec = crypto(braidchain_archive)

@test audit(ballotbox_archive, spec)
@test audit(braidchain_archive)

@show tally(ballotbox_archive)</code></pre><p>Note that <code>spec</code> is read from the <code>DemeSpec</code> record in the braidchain which can be trusted as  the tree braidchain ledger checksum is listed within a proposal&#39;s anchor. The proposal is  the first record in history tree for the ballotbox thus it is bound to <code>ledger_root</code>  checksum and so demespec record is also tied to <code>ledger_root</code>.</p><p>For convinience an <code>audit</code> method is provided which audits both archives at the same time:</p><pre><code class="nohighlight hljs">braidchain_archive = get_ballotbox_archive(uuid)
ballotbox_archive = get_ballotbox_archive(uuid, proposal_index)[1:ledger_length]

@test checksum(ballotbox_archive, hasher) == ledger_root
@test audit(braidchain_archive, ballotbox_archive, hasher)

@show tally(ballotbox_archive)</code></pre><p>Note that this audit does not check honesty of the <code>registrar</code> that it have not admitted fake users to gain more influence in the ellection result. Properties being verified by the audit:</p><ul><li>Legitimacy: only and all eligiable voters cast their votes;</li><li>Fairness: every eligiable voter can vote at most once;</li><li>Immutability: no vote can be deleted or modified when recorded in the ledger; </li><li>Tallied as Cast: all cast votes are counted honestly to predetermined procedure; </li><li>Software independence: the previously audited properties for the evidence does not </li></ul><p>depend on a trust in honest execution of peacefounder service nor honesty of the braiders who provides new pseudonyms for the deme members. In other words the previously listed  properties would not be altered if adversary would have a full control over the peacefounder  service and the braiders. </p><p>The immutability is ensured from voter&#39;s clients updating their consistency proof chain which includes their vote. If the vote gets removed from a chain every single voter who had cast their vote would get a proof for inconsistent ledger state called blame. The blame can be made public by the voter without revealing it&#39;s vote and thus ensures immutability and also persitance after votes are published. The auditable part here are the votes themselves signed with pseudonym which contract voter&#39;s clients to follow up at latter periods with consistency proofs. On top of that, other monitors can synchronize the ballotbox ledger and add assurances that way.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PeaceFounder/PeaceFounder.jl/blob/b627d7a59966f9d37208197acc0ebeb2f21d4d42/src/AuditTools.jl#L1-L64">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PeaceFounder.AuditTools.BallotBoxArchive" href="#PeaceFounder.AuditTools.BallotBoxArchive"><code>PeaceFounder.AuditTools.BallotBoxArchive</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">struct BallotBoxArchive
    proposal::Proposal
    seed::Digest
    ledger::Vector{CastRecord}
end</code></pre><p>Represents a ballotbox ledger archive. Contains a <code>proposal</code> for which votes have been collected;  <code>seed</code> initialized by collector and <code>ledger</code> containing all cast records.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PeaceFounder/PeaceFounder.jl/blob/b627d7a59966f9d37208197acc0ebeb2f21d4d42/src/AuditTools.jl#L86-L95">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PeaceFounder.AuditTools.BraidChainArchive" href="#PeaceFounder.AuditTools.BraidChainArchive"><code>PeaceFounder.AuditTools.BraidChainArchive</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">struct BraidChainArchive
    ledger::Vector{Transaction}
end</code></pre><p>Represents a braidchain ledger archive. </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PeaceFounder/PeaceFounder.jl/blob/b627d7a59966f9d37208197acc0ebeb2f21d4d42/src/AuditTools.jl#L72-L78">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PeaceFounder.AuditTools.archive" href="#PeaceFounder.AuditTools.archive"><code>PeaceFounder.AuditTools.archive</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">archive(ledger::BraidChain)::BraidChainArchive
archive(ledger::BallotBox)::BallotBoxArchive</code></pre><p>Form an archive of braidchain or ballotbox which can be sent over wire to be audited. </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PeaceFounder/PeaceFounder.jl/blob/b627d7a59966f9d37208197acc0ebeb2f21d4d42/src/AuditTools.jl#L106-L111">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PeaceFounder.AuditTools.audit" href="#PeaceFounder.AuditTools.audit"><code>PeaceFounder.AuditTools.audit</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">audit(archive::BallotBoxArchive, spec::CryptoSpec)</code></pre><p>Check that recorded votes are consistent with proposal ballot and that cryptographic signature  of every recorded vote is correct.  –-</p><pre><code class="nohighlight hljs">audit(archive::BraidChainArchive)</code></pre><p>Check that the braidchain ledger is consistent. Runs through </p><pre><code class="nohighlight hljs">- [`audit_members`](@ref)
- [`audit_braids`](@ref) 
- [`audit_proposals`](@ref)
- [`audit_roster`](@ref)
- [`audit_lots`](@ref)</code></pre><hr/><pre><code class="nohighlight hljs">audit(ballotbox_archive::BraidChainArchive, ballotbox_archive::BallotBoxArchive, hasher)</code></pre><p>Audits each ledger seperatelly and then checks consistency between themselves: such as that only valid member pseudonyms have cast their votes, that proposal is available in the braidchain ledger.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PeaceFounder/PeaceFounder.jl/blob/b627d7a59966f9d37208197acc0ebeb2f21d4d42/src/AuditTools.jl#L177-L201">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PeaceFounder.AuditTools.audit_braids" href="#PeaceFounder.AuditTools.audit_braids"><code>PeaceFounder.AuditTools.audit_braids</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">audit_braids(ledger::BraidChainArchive)</code></pre><p>Individually check every braid and it&#39;s zero knowledge proof and it&#39;s consistency with the chain.  For the latter, that input pseudonyms and relative generator to a braid come from a previous output  braiding output and newly registered members. </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PeaceFounder/PeaceFounder.jl/blob/b627d7a59966f9d37208197acc0ebeb2f21d4d42/src/AuditTools.jl#L128-L134">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PeaceFounder.AuditTools.audit_lots" href="#PeaceFounder.AuditTools.audit_lots"><code>PeaceFounder.AuditTools.audit_lots</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">audit_lots(ledger::BraidChainArchive)</code></pre><p>Check integrity correct nonce commitments. Note that it is possible that this will be moved out  to a ballotbox ledger in the future. Also service like DRAND would be beneficial to reduce trust assumptions.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PeaceFounder/PeaceFounder.jl/blob/b627d7a59966f9d37208197acc0ebeb2f21d4d42/src/AuditTools.jl#L147-L153">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PeaceFounder.AuditTools.audit_members" href="#PeaceFounder.AuditTools.audit_members"><code>PeaceFounder.AuditTools.audit_members</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">audit_members(ledger::BraidChainArchive)</code></pre><p>Check every member registration certificate consistency with the ledger. In particular:     - Admission approved by a trusted entity at that time;     - Membership approved by a admitted identity only once;     - Every member psuedonym is generated with the current relative generator in the braidchain ledger;</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PeaceFounder/PeaceFounder.jl/blob/b627d7a59966f9d37208197acc0ebeb2f21d4d42/src/AuditTools.jl#L137-L144">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PeaceFounder.AuditTools.audit_proposals" href="#PeaceFounder.AuditTools.audit_proposals"><code>PeaceFounder.AuditTools.audit_proposals</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">audit_proposals(ledger::BraidChainArchive)</code></pre><p>Check every proposal for it&#39;s consistency with the chain. In particular:     - Every proposal is signed by a valid proposer at the time of inclusion in the ledger;     - Anchor in within the proposal is consistent with the ledger;      - Every proposal has a unique UUID as well as it&#39;s title is        sufficiently different from previous ones;</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PeaceFounder/PeaceFounder.jl/blob/b627d7a59966f9d37208197acc0ebeb2f21d4d42/src/AuditTools.jl#L165-L173">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PeaceFounder.AuditTools.audit_roster" href="#PeaceFounder.AuditTools.audit_roster"><code>PeaceFounder.AuditTools.audit_roster</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">audit_roster(ledger::BraidChainArchive)</code></pre><p>Check that every <code>DemeSpec</code> transaction in the ledger is correctly signed by the guardian.  </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PeaceFounder/PeaceFounder.jl/blob/b627d7a59966f9d37208197acc0ebeb2f21d4d42/src/AuditTools.jl#L157-L161">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PeaceFounder.AuditTools.checksum" href="#PeaceFounder.AuditTools.checksum"><code>PeaceFounder.AuditTools.checksum</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">checksum(ledger::Union{BraidChainArchive, BallotBoxArchive}, hasher)::Digest</code></pre><p>Calculate a history tree root from a given ledger records. Meant to be used to check integrity of the received data. </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PeaceFounder/PeaceFounder.jl/blob/b627d7a59966f9d37208197acc0ebeb2f21d4d42/src/AuditTools.jl#L119-L124">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../model_api/">« PeaceFounder.Model</a><a class="docs-footer-nextpage" href="../schedulers/">PeaceFounder.Schedulers »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.25 on <span class="colophon-date" title="Sunday 3 March 2024 09:35">Sunday 3 March 2024</span>. Using Julia version 1.9.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
